{"version":3,"sources":["webpack:///./src/views/user/components/Dialog.vue?7a91","webpack:///src/views/user/components/Dialog.vue","webpack:///./src/views/user/components/Dialog.vue?7422","webpack:///./src/views/user/components/Dialog.vue?f3b0","webpack:///../../../src/mixins/delayable/index.ts","webpack:///../../../src/components/VDivider/VDivider.ts","webpack:///../../../src/components/VHover/VHover.ts","webpack:///./src/views/user/components/Dialog.vue?f778"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_l","user","index","key","sid","scopedSlots","_u","fn","ref","hover","on","$event","switchMessages","_v","_s","nickName","unread","_e","stopPropagation","closeHistory","staticStyle","history","currentMessageIndex","message","directives","name","rawName","value","send_user_id","expression","profile_photo","class","message_content","type","indexOf","_k","keyCode","sendMessage","proxy","model","callback","$$v","$set","trim","staticRenderFns","created","mounted","watch","setTimeout","data","message_id","message_time","receive_user_id","$route","params","user_id","message_read","sockets","receiveMessage","_this","messages","undefined","msgLength","Object","keys","$axios","method","url","sent","currentMessages","beforeDestroy","recordHistory","destroyed","window","removeEventListener","methods","beforeunloadFn","localStorage","setItem","$socket","emit","resetSetItem","scrollToBottom","container","scrollTop","scrollHeight","component","VAvatar","VBtn","VCard","VCardText","VCardTitle","VCol","VContainer","VContent","VDivider","VHover","VIcon","VImg","VList","VListItem","VListItemAvatar","VListItemContent","VListItemGroup","VListItemTitle","VRow","VTextField","props","openDelay","Number","default","closeDelay","openTimeout","closeTimeout","clearDelay","clearTimeout","runDelay","delay","parseInt","cb","open","close","inset","vertical","Boolean","$attrs","role","orientation","h","themeClasses","$listeners","disabled","onMouseEnter","onMouseLeave","$scopedSlots","element","isActive","Array","mouseenter","mouseleave"],"mappings":"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","file":"js/chunk-bd4f0f6a.a228e3e3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-content',[_c('v-img',{staticClass:\"bdBackground\",attrs:{\"src\":require(\"@/assets/img/1.png\"),\"height\":\"100%\",\"width\":\"100%\"}}),_c('v-container',[_c('v-row',[_c('v-col',[_c('v-card',{attrs:{\"width\":\"100%\",\"height\":\"500px\",\"color\":\"#FFFDE7\",\"tile\":\"\"}},[_c('v-row',{staticClass:\"ma-0\"},[_c('v-col',{staticClass:\"pa-0\",attrs:{\"cols\":\"3\"}},[_c('v-list',{staticClass:\"pa-0\",attrs:{\"color\":\"#FFFDE7\"}},[_c('v-list-item-group',[_vm._l((_vm.history),function(user,index){return _c('v-hover',{key:user.sid,scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar hover = ref.hover;\nreturn [_c('v-list-item',{on:{\"click\":function($event){return _vm.switchMessages(index)}}},[[_c('v-list-item-avatar',[_c('v-img',{attrs:{\"src\":\"http://fs.budingcc.cn:8888/group1/M00/00/00/dU4Lkl5OjIeAG6SWAABMN7CE7-U017.jpg\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(_vm._s(user.nickName))])],1),(user.unread!=0)?_c('v-avatar',{attrs:{\"color\":\"red\",\"size\":\"20\"}},[_c('span',{staticClass:\"white--text\"},[_vm._v(_vm._s(user.unread))])]):_vm._e(),(hover&&index!=0)?_c('v-icon',{on:{\"click\":function($event){$event.stopPropagation();return _vm.closeHistory(user.sid)}}},[_vm._v(\"mdi-close\")]):_vm._e()]],2)]}}],null,true)})})],2)],1)],1),_c('v-col',{staticStyle:{\"height\":\"500px\"}},[_c('v-card',{attrs:{\"height\":\"100%\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.history[_vm.currentMessageIndex].nickName))]),_c('v-divider'),_c('v-card-text',{staticClass:\"chat_box\",staticStyle:{\"height\":\"78%\",\"overflow\":\"auto\"}},_vm._l((_vm.history[_vm.currentMessageIndex].messages),function(message,index){return _c('v-list-item',{key:index},[_c('v-list-item-avatar',{directives:[{name:\"show\",rawName:\"v-show\",value:(message.send_user_id!=_vm.user.sid),expression:\"message.send_user_id!=user.sid\"}]},[_c('v-img',{attrs:{\"src\":_vm.history[_vm.currentMessageIndex].profile_photo}})],1),_c('v-list-item-content',[_c('v-list-item-title',{class:{'text-right':message.send_user_id==_vm.user.sid}},[_vm._v(_vm._s(message.message_content))])],1),_c('v-list-item-avatar',{directives:[{name:\"show\",rawName:\"v-show\",value:(message.send_user_id==_vm.user.sid),expression:\"message.send_user_id==user.sid\"}]},[_c('v-img',{attrs:{\"src\":_vm.user.profile_photo}})],1)],1)}),1),_c('v-divider'),_c('v-text-field',{attrs:{\"placeholder\":\"ENTER发送消息\",\"solo\":\"\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.sendMessage($event)}},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('v-btn',{attrs:{\"color\":\"success\"},on:{\"click\":_vm.sendMessage}},[_vm._v(\"发送\")])]},proxy:true}]),model:{value:(_vm.message.message_content),callback:function ($$v) {_vm.$set(_vm.message, \"message_content\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"message.message_content\"}})],1)],1)],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-content>\r\n    <v-img src=\"@/assets/img/1.png\" class=\"bdBackground\" height=\"100%\" width=\"100%\"></v-img>\r\n    <v-container>\r\n      <v-row>\r\n        <v-col>\r\n          <v-card width=\"100%\" height=\"500px\" color=\"#FFFDE7\" tile>\r\n            <v-row class=\"ma-0\">\r\n              <v-col cols=\"3\" class=\"pa-0\">\r\n                <v-list class=\"pa-0\" color=\"#FFFDE7\">\r\n                  <v-list-item-group>\r\n                    <template>\r\n                      <v-hover\r\n                        v-slot:default=\"{hover}\"\r\n                        v-for=\"(user,index) in history\"\r\n                        :key=\"user.sid\"\r\n                      >\r\n                        <v-list-item @click=\"switchMessages(index)\">\r\n                          <template>\r\n                            <v-list-item-avatar>\r\n                              <v-img\r\n                                src=\"http://fs.budingcc.cn:8888/group1/M00/00/00/dU4Lkl5OjIeAG6SWAABMN7CE7-U017.jpg\"\r\n                              ></v-img>\r\n                            </v-list-item-avatar>\r\n                            <v-list-item-content>\r\n                              <v-list-item-title>{{user.nickName}}</v-list-item-title>\r\n                            </v-list-item-content>\r\n                            <v-avatar color=\"red\" size=\"20\" v-if=\"user.unread!=0\">\r\n                              <span class=\"white--text\">{{user.unread}}</span>\r\n                            </v-avatar>\r\n\r\n                            <v-icon\r\n                              v-if=\"hover&&index!=0\"\r\n                              @click.stop=\"closeHistory(user.sid)\"\r\n                            >mdi-close</v-icon>\r\n                          </template>\r\n                        </v-list-item>\r\n                      </v-hover>\r\n                    </template>\r\n                  </v-list-item-group>\r\n                </v-list>\r\n              </v-col>\r\n              <v-col style=\"height:500px\">\r\n                <v-card height=\"100%\">\r\n                  <v-card-title>{{history[currentMessageIndex].nickName}}</v-card-title>\r\n                  <v-divider></v-divider>\r\n                  <v-card-text style=\"height:78%;overflow:auto;\" class=\"chat_box\">\r\n                    <v-list-item\r\n                      v-for=\"(message,index) in history[currentMessageIndex].messages\"\r\n                      :key=\"index\"\r\n                    >\r\n                      <v-list-item-avatar v-show=\"message.send_user_id!=user.sid\">\r\n                        <v-img :src=\"history[currentMessageIndex].profile_photo\"></v-img>\r\n                      </v-list-item-avatar>\r\n                      <v-list-item-content>\r\n                        <v-list-item-title\r\n                          :class=\"{'text-right':message.send_user_id==user.sid}\"\r\n                        >{{message.message_content}}</v-list-item-title>\r\n                      </v-list-item-content>\r\n                      <v-list-item-avatar v-show=\"message.send_user_id==user.sid\">\r\n                        <v-img :src=\"user.profile_photo\"></v-img>\r\n                      </v-list-item-avatar>\r\n                    </v-list-item>\r\n                  </v-card-text>\r\n                  <v-divider></v-divider>\r\n                  <v-text-field\r\n                    v-model.trim=\"message.message_content\"\r\n                    placeholder=\"ENTER发送消息\"\r\n                    solo\r\n                    @keydown.enter=\"sendMessage\"\r\n                  >\r\n                    <template v-slot:append>\r\n                      <v-btn color=\"success\" @click=\"sendMessage\">发送</v-btn>\r\n                    </template>\r\n                  </v-text-field>\r\n                </v-card>\r\n              </v-col>\r\n            </v-row>\r\n          </v-card>\r\n        </v-col>\r\n      </v-row>\r\n    </v-container>\r\n  </v-content>\r\n</template>\r\n<style>\r\n.chat_box::-webkit-scrollbar {\r\n  width: 0;\r\n}\r\n</style>\r\n<script>\r\nimport $qs from \"qs\";\r\nimport Vue from \"vue\";\r\n// import VueSocketIO from \"vue-socket.io\";\r\nexport default {\r\n  name: \"chat\",\r\n  created() {\r\n    // if (!this.$socket) {\r\n    //   this.$router.push({ path: \"/\" });\r\n    // }\r\n    // this.user = $qs.parse(sessionStorage.getItem(\"loginInfo\"));\r\n    // this.message.send_user_id = this.user.sid;\r\n    // this.history = $qs.parse(localStorage.getItem(\"history-\" + this.user.sid));\r\n  },\r\n  mounted() {\r\n    // window.addEventListener(\"beforeunload\", e => this.beforeunloadFn(e));\r\n    // this.resetSetItem(\r\n    //   \"unRead\",\r\n    //   parseInt(sessionStorage.getItem(\"unRead\")) - this.history[0].unread\r\n    // );\r\n    // this.history[0].unread = 0;\r\n    // setTimeout(() => {\r\n    //   this.scrollToBottom();\r\n    // }, 30);\r\n  },\r\n  watch: {\r\n    currentMessageIndex() {\r\n      setTimeout(() => {\r\n        this.scrollToBottom();\r\n      }, 30);\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      user: {\r\n        nickName: \"Ikaros\"\r\n      },\r\n      currentMessageIndex: 0,\r\n      //   this.$route.params.user_id\r\n      //     ? this.$route.params.user_id\r\n      //     : 0,\r\n      message: {\r\n        message_id: null,\r\n        message_content: null,\r\n        message_time: null,\r\n        send_user_id: null,\r\n        receive_user_id: this.$route.params.user_id\r\n          ? this.$route.params.user_id\r\n          : 0,\r\n        message_read: null\r\n      },\r\n      history: [\r\n        {\r\n          nickName: \"杨佩斯\"\r\n        }\r\n      ]\r\n    };\r\n  },\r\n  sockets: {\r\n    receiveMessage(data) {\r\n      var _this = this;\r\n      if (this.history[data.send_user_id]) {\r\n        if (!this.history[data.send_user_id].messages) {\r\n          this.history[data.send_user_id].messages = [];\r\n        }\r\n        var message_id = data.message_id;\r\n        delete this.history[data.send_user_id].messages[undefined];\r\n        var msgLength = Object.keys(this.history[data.send_user_id].messages)\r\n          .length;\r\n        Vue.set(this.history[data.send_user_id].messages, msgLength, data);\r\n        if (data.send_user_id != this.currentMessageIndex) {\r\n          this.history[data.send_user_id].unread =\r\n            parseInt(this.history[data.send_user_id].unread) + 1;\r\n        }\r\n      } else {\r\n        this.$axios({\r\n          method: \"get\",\r\n          url: \"/user/profile/\" + data.send_user_id\r\n        })\r\n          .then(result => {\r\n            Vue.set(_this.history, data.send_user_id, {\r\n              sid: data.send_user_id,\r\n              nickname: result.data.nick_name,\r\n              profile_photo: result.data.profile_photo,\r\n              messages: [data],\r\n              unread: 1\r\n            });\r\n          })\r\n          .catch(err => {});\r\n      }\r\n      setTimeout(() => {\r\n        this.scrollToBottom();\r\n      }, 30);\r\n    },\r\n    sent(data) {\r\n      var currentMessages = this.history[this.currentMessageIndex];\r\n      if (!currentMessages.messages) {\r\n        currentMessages.messages = [];\r\n      }\r\n      Vue.set(currentMessages.messages, currentMessages.messages.length, data);\r\n      this.message.message_content = \"\";\r\n      setTimeout(() => {\r\n        this.scrollToBottom();\r\n      }, 30);\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    this.recordHistory();\r\n  },\r\n  destroyed() {\r\n    window.removeEventListener(\"beforeunload\", e => this.beforeunloadFn(e));\r\n  },\r\n  methods: {\r\n    closeHistory(index) {\r\n      this.currentMessageIndex = 0;\r\n      Vue.delete(this.history, index);\r\n    },\r\n    beforeunloadFn(e) {\r\n      this.recordHistory();\r\n    },\r\n    recordHistory() {\r\n      localStorage.setItem(\r\n        \"history-\" + this.user.sid,\r\n        $qs.stringify(this.history)\r\n      );\r\n    },\r\n\r\n    sendMessage() {\r\n      if (\r\n        this.message.message_content != null &&\r\n        this.message.message_content != \"\"\r\n      ) {\r\n        this.$socket.emit(\"sendMessage\", this.message);\r\n      }\r\n    },\r\n    switchMessages(index) {\r\n      this.currentMessageIndex = index;\r\n      this.message.receive_user_id = this.history[this.currentMessageIndex].sid;\r\n      this.resetSetItem(\r\n        \"unRead\",\r\n        parseInt(sessionStorage.getItem(\"unRead\")) - this.history[index].unread\r\n      );\r\n      this.history[index].unread = 0;\r\n    },\r\n    scrollToBottom() {\r\n      const container = this.$el.querySelector(\".chat_box\");\r\n      if (container) {\r\n        container.scrollTop = container.scrollHeight;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Dialog.vue?vue&type=template&id=42ceb653&\"\nimport script from \"./Dialog.vue?vue&type=script&lang=js&\"\nexport * from \"./Dialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Dialog.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAvatar } from 'vuetify/lib/components/VAvatar';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VContent } from 'vuetify/lib/components/VContent';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VHover } from 'vuetify/lib/components/VHover';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VList } from 'vuetify/lib/components/VList';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemAvatar } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemGroup } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VAvatar,VBtn,VCard,VCardText,VCardTitle,VCol,VContainer,VContent,VDivider,VHover,VIcon,VImg,VList,VListItem,VListItemAvatar,VListItemContent,VListItemGroup,VListItemTitle,VRow,VTextField})\n","import Vue from 'vue'\n\n/**\n * Delayable\n *\n * @mixin\n *\n * Changes the open or close delay time for elements\n */\nexport default Vue.extend<Vue & { isActive?: boolean }>().extend({\n  name: 'delayable',\n\n  props: {\n    openDelay: {\n      type: [Number, String],\n      default: 0,\n    },\n    closeDelay: {\n      type: [Number, String],\n      default: 0,\n    },\n  },\n\n  data: () => ({\n    openTimeout: undefined as number | undefined,\n    closeTimeout: undefined as number | undefined,\n  }),\n\n  methods: {\n    /**\n     * Clear any pending delay timers from executing\n     */\n    clearDelay (): void {\n      clearTimeout(this.openTimeout)\n      clearTimeout(this.closeTimeout)\n    },\n    /**\n     * Runs callback after a specified delay\n     */\n    runDelay (type: 'open' | 'close', cb?: () => void): void {\n      this.clearDelay()\n\n      const delay = parseInt((this as any)[`${type}Delay`], 10)\n\n      ;(this as any)[`${type}Timeout`] = setTimeout(cb || (() => {\n        this.isActive = { open: true, close: false }[type]\n      }), delay)\n    },\n  },\n})\n","// Styles\nimport './VDivider.sass'\n\n// Types\nimport { VNode } from 'vue'\n\n// Mixins\nimport Themeable from '../../mixins/themeable'\n\nexport default Themeable.extend({\n  name: 'v-divider',\n\n  props: {\n    inset: Boolean,\n    vertical: Boolean,\n  },\n\n  render (h): VNode {\n    // WAI-ARIA attributes\n    let orientation\n    if (!this.$attrs.role || this.$attrs.role === 'separator') {\n      orientation = this.vertical ? 'vertical' : 'horizontal'\n    }\n    return h('hr', {\n      class: {\n        'v-divider': true,\n        'v-divider--inset': this.inset,\n        'v-divider--vertical': this.vertical,\n        ...this.themeClasses,\n      },\n      attrs: {\n        role: 'separator',\n        'aria-orientation': orientation,\n        ...this.$attrs,\n      },\n      on: this.$listeners,\n    })\n  },\n})\n","// Mixins\nimport Delayable from '../../mixins/delayable'\nimport Toggleable from '../../mixins/toggleable'\n\n// Utilities\nimport mixins from '../../util/mixins'\nimport { consoleWarn } from '../../util/console'\n\n// Types\nimport { VNode, ScopedSlotChildren } from 'vue/types/vnode'\n\nexport default mixins(\n  Delayable,\n  Toggleable\n  /* @vue/component */\n).extend({\n  name: 'v-hover',\n\n  props: {\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n    value: {\n      type: Boolean,\n      default: undefined,\n    },\n  },\n\n  methods: {\n    onMouseEnter () {\n      this.runDelay('open')\n    },\n    onMouseLeave () {\n      this.runDelay('close')\n    },\n  },\n\n  render (): VNode {\n    if (!this.$scopedSlots.default && this.value === undefined) {\n      consoleWarn('v-hover is missing a default scopedSlot or bound value', this)\n\n      return null as any\n    }\n\n    let element: VNode | ScopedSlotChildren\n\n    /* istanbul ignore else */\n    if (this.$scopedSlots.default) {\n      element = this.$scopedSlots.default({ hover: this.isActive })\n    }\n\n    if (Array.isArray(element) && element.length === 1) {\n      element = element[0]\n    }\n\n    if (!element || Array.isArray(element) || !element.tag) {\n      consoleWarn('v-hover should only contain a single element', this)\n\n      return element as any\n    }\n\n    if (!this.disabled) {\n      element.data = element.data || {}\n      this._g(element.data, {\n        mouseenter: this.onMouseEnter,\n        mouseleave: this.onMouseLeave,\n      })\n    }\n\n    return element\n  },\n})\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}